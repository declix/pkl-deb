/// Tests for SourcesList module functionality
amends "pkl:test"

import "../SourcesList.pkl"

examples {
    ["Basic entry"] {
        new SourcesList.Entry {
            archiveType = "deb"
            uri = "http://deb.debian.org/debian"
            suite = "bookworm"
            components = new Listing { "main" }
        }
    }
    
    ["Entry with multiple components"] {
        new SourcesList.Entry {
            archiveType = "deb"
            uri = "http://deb.debian.org/debian"
            suite = "bookworm"
            components = new Listing { "main"; "contrib"; "non-free" }
        }
    }
    
    ["Source repository entry"] {
        new SourcesList.Entry {
            archiveType = "deb-src"
            uri = "http://deb.debian.org/debian"
            suite = "bookworm"
            components = new Listing { "main" }
        }
    }
    
    ["Entry with architecture option"] {
        new SourcesList.Entry {
            archiveType = "deb"
            options = new SourcesList.EntryOptions {
                architectures = new Listing { "amd64" }
            }
            uri = "http://deb.debian.org/debian"
            suite = "bookworm"
            components = new Listing { "main" }
        }
    }
    
    ["Entry with multiple options"] {
        new SourcesList.Entry {
            archiveType = "deb"
            options = new SourcesList.EntryOptions {
                architectures = new Listing { "amd64"; "arm64" }
                signedBy = "/usr/share/keyrings/example.gpg"
                trusted = false
            }
            uri = "https://example.com/debian"
            suite = "bookworm"
            components = new Listing { "main" }
        }
    }
    
    ["Entry with PDiffs disabled"] {
        new SourcesList.Entry {
            archiveType = "deb"
            options = new SourcesList.EntryOptions {
                pdiffs = false
            }
            uri = "http://deb.debian.org/debian"
            suite = "bookworm"
            components = new Listing { "main" }
        }
    }
}